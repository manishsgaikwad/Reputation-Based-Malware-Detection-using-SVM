
# coding: vaibhav


import pandas as pd
from sklearn import svm
from sklearn.svm import SVC
from sklearn.feature_selection import chi2
from sklearn.metrics import accuracy_score
from sklearn.feature_selection import SelectKBest
from sklearn.model_selection import train_test_split

data = pd.read_csv("data_new.csv")
X2=data.drop(['Class','Malware'],axis=1)
y2=data.Class
z2=data.Malware
X_new= SelectKBest(chi2, k=500)
var1=X_new.fit_transform(X2,y2)
features=X_new.get_support(indices=True)
features=[column for column in X2[features]]
#len(features)
df=pd.DataFrame(var1,columns=features)
df1=pd.concat([df,y2,z2],axis=1,join='inner') #Concatenating selected features and and class
df1.to_csv("selectedKbest.csv",index=False)

